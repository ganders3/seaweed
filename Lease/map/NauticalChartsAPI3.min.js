function NauticalChartsAPI(){return this.version="2.1.0",this.opacity=.8,this.charts=[],this._loaded=!1,this.m_initializeRNCs(),this}function Chart(t){return this.api=t,this.number=null,this.title=null,this.sourceEdition=null,this.rasterEdition=null,this.ntmEdition=null,this.sourceDate=null,this.ntmDate=null,this.panels=[],this}function Panel(t){return this.chart=t,this.encodedPolygon=null,this.encodedLevels=null,this.polygon=null,this.scale=null,this.maxZoom=null,this.fileName=null,this.number=null,this}NauticalChartsAPI.prototype=new Object,NauticalChartsAPI.prototype.isLoaded=function(){return this._loaded},NauticalChartsAPI.prototype.getChartByNumber=function(t){for(var e=0,n=this.charts.length;e<n;e++)if(this.charts[e].getNumber()==t)return this.charts[e];return null},NauticalChartsAPI.prototype.getPanelByFileName=function(t){var e=t.split("_")[0],n=this.getChartByNumber(e);return n?n.getPanelByFileName(t):null},NauticalChartsAPI.prototype.getPanelByNumber=function(t){for(var e=0,n=this.charts.length;e<n;e++)for(var o=this.charts[e].getPanels(),a=0,r=o.length;a<r;a++)if(o[a].getNumber()==t)return o[a];return null},NauticalChartsAPI.prototype.getCharts=function(){return this.charts},NauticalChartsAPI.prototype.getChartsByLatLng=function(t){for(var e=[],n=0,o=this.charts.length;n<o;n++)this.charts[n].hasLatLng(t)&&e.push(this.charts[n]);return e},NauticalChartsAPI.prototype.getPanelsByLatLng=function(t){for(var e=[],n=0,o=this.charts.length;n<o;n++)for(var a=0,r=this.charts[n].panels.length;a<r;a++)this.charts[n].panels[a].hasLatLng(t)&&e.push(this.charts[n].panels[a]);return e},NauticalChartsAPI.prototype.getChartsByBounds=function(t){for(var e=[],n=0,o=this.charts.length;n<o;n++)this.charts[n].overlapsBounds(t)&&e.push(this.charts[n]);return e},NauticalChartsAPI.prototype.getPanelsByBounds=function(t){for(var e=[],n=0,o=this.charts.length;n<o;n++)for(var a=0,r=this.charts[n].panels.length;a<r;a++)this.charts[n].panels[a].overlapsBounds(t)&&e.push(this.charts[n].panels[a]);return e},NauticalChartsAPI.prototype.getChartsByBoundsNESW=function(t,e,n,o){var a=new google.maps.Bounds(new google.maps.LatLng(n,o),new google.maps.LatLng(t,e));return this.getChartsByBounds(a)},NauticalChartsAPI.prototype.getPanelsByBoundsNESW=function(t,e,n,o){var a=new google.maps.LatLngBounds(new google.maps.LatLng(n,o),new google.maps.LatLng(t,e));return this.getPanelsByBounds(a)},NauticalChartsAPI.prototype.getOpacity=function(){return this.opacity},NauticalChartsAPI.prototype.setOpacity=function(t){return t=+t,this.opacity=t>1?t>100?1:t/100:t<0?0:t,google.maps.event.trigger(this,"opacity_changed",this.opacity),!(t>100||t<0)},NauticalChartsAPI.prototype.m_initializeRNCs=function(){this._loaded=!1;var t=this,e=function(e,n){t.charts=[];for(var o=0,a=e.length;o<a;o++){t.charts[o]=new Chart(t);var r=t.charts[o];r.number=e[o].chart_id,r.title=e[o].title,r.sourceEdition=e[o].source_edition,r.rasterEdition=e[o].raster_edition,r.ntmEdition=e[o].ntm_edition,r.sourceDate=e[o].source_date,r.ntmDate=e[o].ntm_date;for(var s=0,i=e[o].panels.length;s<i;s++){var l=e[o].panels[s];t.charts[o].panels[s]=new Panel(r);var h=t.charts[o].panels[s];h.encodedPolygon=l.encoded_polygon,h.encodedLevels=l.encoded_levels,h.scale=parseInt(l.scale),l.max_zoom&&(h.maxZoom=parseInt(l.max_zoom)),h.fileName=l.file_name.toUpperCase(),h.number=l.panel_no}}t._loaded=!0,void 0!==google.maps.event&&google.maps.event.trigger(t,"load")};"undefined"==typeof jQuery?this.m_appendScript("http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js","jquery_143",function(){jQuery.getJSON("http://cordc.ucsd.edu/js/RNC/rnc.php?callback=?",e)}):jQuery.getJSON("http://cordc.ucsd.edu/js/RNC/rnc.php?callback=?",e)},NauticalChartsAPI.prototype.m_appendScript=function(t,e,n){e=void 0===e?"__nci_"+(new Date).getTime()+"_"+Math.round(1e3*Math.random()):"__nci_"+e;var o=document.getElementsByTagName("head")[0],a=document.getElementById(e);a&&o.removeChild(a),script=document.createElement("script"),script.src=t,script.type="text/javascript",script.id=e,script.onload_done=!1;var r=this;return script.onload=function(){script.onload_done||(script.onload_done=!0,r.m_tell(e),void 0!==n&&n.call(r))},script.onreadystatechange=function(){"loaded"!==script.readyState&&"complete"!==script.readyState||script.onload_done||(script.onload_done=!0,r.m_tell(e),void 0!==n&&n.call(r))},o.appendChild(script),this.m_wait(e,!0),!0},NauticalChartsAPI.prototype.m_tell=function(t){return void 0===this.m_notices&&(this.m_notices=[]),void 0===this.m_notices[t]?this.m_notices[t]=[!0,null]:this.m_notices[t][0]=!0,!0},NauticalChartsAPI.prototype.m_wait=function(t,e){if(void 0===this.m_notices&&(this.m_notices=[]),void 0===e&&void 0!==this.m_notices[t]||(this.m_notices[t]=[!1,null]),this.m_notices[t][1]&&(window.clearTimeout(this.m_notices[t][1]),this.m_notices[t][1]=null),this.m_notices[t][0])return!0},Chart.prototype=new Object,Chart.prototype.getAPI=function(){return this.api},Chart.prototype.getNumber=function(){return this.number},Chart.prototype.getTitle=function(){return this.title},Chart.prototype.getSourceEdition=function(){return this.sourceEdition},Chart.prototype.getRasterEdition=function(){return this.rasterEdition},Chart.prototype.getNTMEdition=function(){return this.ntmEdition},Chart.prototype.getSourceDate=function(){return this.sourceDate},Chart.prototype.getNTMDate=function(){return this.ntmDate},Chart.prototype.getBounds=function(){if(this.panels.length<1)return null;for(var t=this.panels[0].getBounds(),e=1,n=this.panels.length;e<n;e++){var o=this.panels[e].getBounds();t.extend(o.getSouthWest()),t.extend(o.getNorthEast())}return t},Chart.prototype.hasLatLng=function(t){for(var e=0,n=this.panels.length;e<n;e++)if(this.panels[e].hasLatLng(t))return!0;return!1},Chart.prototype.overlapsBounds=function(t){return t.intersects(this.getBounds())},Chart.prototype.overlapsBoundsNESW=function(t,e,n,o){var a=new google.maps.LatLngBounds(new google.maps.LatLng(n,o),new google.maps.LatLng(t,e));return this.overlapsBounds(a)},Chart.prototype.getPanels=function(){return this.panels},Chart.prototype.getPanelByFileName=function(t){for(var e=0,n=this.panels.length;e<n;e++)if(this.panels[e].matchesFileName(t))return this.panels[e];return null},Chart.prototype.getPanelByNumber=function(t){for(var e=0,n=this.panels.length;e<n;e++)if(panels[e].getNumber()==t)return panels[e];return null},Chart.prototype.getPanelsByLatLng=function(t){for(var e=[],n=0,o=this.panels.length;n<o;n++)this.panels[n].hasLatLng(t)&&e.push(this.panels[n]);return e},Chart.prototype.getPanelsByBounds=function(t){for(var e=[],n=0,o=this.panels.length;n<o;n++)this.panels[n].overlapsBounds(t)&&e.push(this.panels[n]);return e},Chart.prototype.getPanelsByBoundsNESW=function(t,e,n,o){var a=new google.maps.LatLngBounds(new google.maps.LatLng(n,o),new google.maps.LatLng(t,e));return this.getPanelsByBounds(a)},Panel.prototype=new Object,Panel.prototype.getAPI=function(){return this.chart.getAPI()},Panel.prototype.getChart=function(){return this.chart},Panel.prototype.getEncodedPolygon=function(){return this.encodedPolygon},Panel.prototype.getEncodedLevels=function(){return this.encodedLevels},Panel.prototype.getPolygon=function(){return this.polygon||(this.polygon=new google.maps.Polygon({paths:google.maps.geometry.encoding.decodePath(this.encodedPolygon),fillColor:"#333",fillOpacity:.1,strokeColor:"#f33",strokeOpacity:.5,strokeWeight:2})),this.polygon},Panel.prototype.getScale=function(){return this.scale},Panel.prototype.getMaxZoom=function(){return this.maxZoom},Panel.prototype.getFileName=function(){return this.fileName},Panel.prototype.matchesFileName=function(t){return t=t.toUpperCase().replace(/^.*?(\/|\\)/,"").replace(/\..*$/,""),this.fileName.replace(/\..*$/,"")==t},Panel.prototype.getNumber=function(){return this.number},Panel.prototype.hasLatLng=function(t){return google.maps.geometry.poly.containsLocation(t,this.getPolygon())},Panel.prototype.getBounds=function(){var t=new google.maps.LatLngBounds;return this.getPolygon().getPath().forEach(function(e){t.extend(e)}),t},Panel.prototype.overlapsBounds=function(t){return t.intersects(this.getBounds())},Panel.prototype.overlapsBoundsNESW=function(t,e,n,o){var a=new google.maps.LatLngBounds(new google.maps.LatLng(n,o),new google.maps.LatLng(t,e));return this.overlapsBounds(a)},Panel.prototype.getMapType=function(){if(void 0===this._mapType){var t=this.getFileName().replace(/\..*$/,""),e=t.split("_")[0],n={alt:t,name:t,minZoom:0,maxZoom:this.getMaxZoom()||18,opacity:this.getAPI().getOpacity()||1,tileSize:new google.maps.Size(256,256),getTileUrl:function(n,o){if(o<this.minZoom||o>this.maxZoom)return null;var a=o<10?"0"+o:o,r=Math.pow(2,o);return"http://mosaic.ucsd.edu/tiles/charts/gif/"+e+"/latest/"+t+"/"+a+"/z"+o+"y"+n.y+"x"+(r+n.x)%r+".gif"}},o=new google.maps.ImageMapType(n);this._mapType=o,google.maps.event.addListener(this.getAPI(),"opacity_changed",function(t){o.setOpacity(t)})}return this._mapType};